@model AccountInfoViewModel;

@{
    ViewData["Title"] = "Profile Info";
}

<style>
    .circle-avatar {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        object-fit: cover;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    .circle-avatar-container {
        width: 100px;
        height: 100px;
        margin: 0 auto 15px auto;
    }

    .list-group-item.no-border {
        border: none !important;
    }

    .list-group:not(:last-child) {
        border-bottom: none;
    }

    .username {
        font-size: 1.7rem;
        font-weight: bold;
        color: #333;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        max-width: 400px;
        margin: 0 auto 20px auto;
        text-align: center;
        text-transform: capitalize;
        letter-spacing: 1px;
    }

    .user-info-container {
        display: flex;
        justify-content: center; /* Center the columns horizontally */
        align-items: flex-start; /* Align the columns to the top */
        gap: 100px; /* Optional: adds space between the columns */
    }

    .user-card-container {
        max-width: 300px;
    }

    .user-content-container {
        flex: 1;
    }


</style>

<div class="user-info-container">

    <div class="user-card-container">
        <div class="circle-avatar-container">
            <img class="circle-avatar" src="~/@Model.AvatarUrl" alt=""/>
        </div>

        <h3 class="username">@Model.Username</h3>

        <div class="card" style="margin: auto;">

            <div class="card-body pb-1">
                <h5 class="card-title">Profile Information</h5>
            </div>

            <ul class="list-group list-group-flush">
                <li class="list-group-item no-border">
                    Username: <strong>@Model.Username</strong>
                </li>
                <li class="list-group-item no-border">
                    Role: <strong>@Model.UserRole</strong>
                </li>
                <li class="list-group-item no-border">
                    Email: <strong>@Model.Email</strong>
                </li>
                <li class="list-group-item no-border">
                    First Name: <strong>@Model.FirstName</strong>
                </li>
                <li class="list-group-item no-border">
                    Last Name: <strong>@Model.LastName</strong>
                </li>

            </ul>

            <ul class="list-group list-group-flush no-border">
                <li class="list-group-item no-border">
                    Enrolled Courses: <strong>@Model.EnrolledCourses.Count</strong>
                </li>
                <li class="list-group-item no-border">
                    Completed Courses: <strong>@Model.CompletedCourses.Count</strong>
                </li>
                <li class="list-group-item no-border">
                    Teaching Courses: <strong>@Model.CreatedCourses.Count</strong>
                </li>


            </ul>

            <ul class="list-group list-group-flush no-border">
                @* <li class="list-group-item no-border"> *@
                @*     Course Comments: <strong>@Model.CourseComments.Count</strong> *@
                @* </li> *@
                <li class="list-group-item no-border">
                    Course Ratings: <strong>@Model.RatedCourses.Count</strong>
                </li>
            </ul>

        </div>

        <form asp-controller="Account" asp-action="Update" method="get">
            <input style="margin: 25px auto; display: block; width: 100%" class="btn btn-primary" type="submit" value="Update Profile"/>
        </form>
    </div>

    <div class="user-content-container">
        <h3 class="username">Enrolled Courses</h3>

        <div class="accordion" id="profileAccordion">
            @foreach (var course in Model.EnrolledCourses)
            {
                <div class="accordion-item">
                    <h2 class="accordion-header" id="heading-@course.Id">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-@course.Id" aria-expanded="false" aria-controls="collapse-@course.Id">
                            @course.Title &nbsp;

                            <span class="badge bg-secondary badge-smaller">
                                @course.StartingDate?.ToString("dd MMM yyyy")
                            </span>
                        </button>
                    </h2>
                    <div id="collapse-@course.Id" class="accordion-collapse collapse" aria-labelledby="heading-@course.Id" data-bs-parent="#coursesAccordion">
                        <div class="accordion-body">

                            <ol class="list-group list-group-flush">
                                @foreach (var lecture in course.Lectures)
                                {
                                <li class="list-group-item d-flex justify-content-between align-items-start">
                                    <div class="ms-2 me-auto">
                                        <div class="fw-bold">
                                            @lecture.Title &nbsp;
                                            @if(lecture.Submissions.Any(s => s.StudentId == Model.Id))
                                            {
                                                <i class="fa-solid fa-circle-check" style="color: green;"></i>
                                            }
                                        </div>
                                    </div>
                                </li>
                                }
                            </ol>

                        </div>
                    </div>
                </div>
            }
        </div>


    </div>
</div>